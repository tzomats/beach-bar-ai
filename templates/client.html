<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beach Chatbot</title>
    <style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
        overflow: hidden; /* Î‘Ï€Î±Î³Î¿ÏÎµÏÎµÎ¹ Ï„Î¿ ÎºÎ¿ÏÎ½Î·Î¼Î± ÏŒÎ»Î·Ï‚ Ï„Î·Ï‚ ÏƒÎµÎ»Î¯Î´Î±Ï‚ */
    }

    body { 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        background-color: #e5ddd5; 
        background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
        display: flex; 
        flex-direction: column; 
    }
    
    .header { 
        height: 60px; /* Î£Ï„Î±Î¸ÎµÏÏŒ ÏÏˆÎ¿Ï‚ */
        background: #075e54; 
        color: white; 
        padding: 0 15px; 
        display: flex; 
        align-items: center; 
        gap: 10px;
        font-weight: bold; 
        z-index: 10;
    }
    
    #chat-box { 
        flex: 1; /* Î Î±Î¯ÏÎ½ÎµÎ¹ ÏŒÎ»Î¿ Ï„Î¿Î½ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ Ï‡ÏÏÎ¿ Î±Î½Î¬Î¼ÎµÏƒÎ± ÏƒÎµ header ÎºÎ±Î¹ input */
        overflow-y: auto; 
        padding: 15px; 
        display: flex; 
        flex-direction: column; 
        gap: 5px;
        -webkit-overflow-scrolling: touch;
    }

    .input-area { 
        height: 70px; /* Î£Ï„Î±Î¸ÎµÏÏŒ ÏÏˆÎ¿Ï‚ Î³Î¹Î± Î½Î± Î¼Î·Î½ ÎºÏÏÎ²ÎµÏ„Î±Î¹ */
        background: #f0f0f0; 
        padding: 10px 15px; 
        display: flex; 
        align-items: center; 
        gap: 10px; 
        border-top: 1px solid #ddd;
        box-sizing: border-box;
    }

    input { 
        flex: 1; 
        border-radius: 25px; 
        border: none; 
        padding: 10px 15px; 
        outline: none; 
        font-size: 16px; /* 16px Î³Î¹Î± Î½Î± Î¼Î·Î½ ÎºÎ¬Î½ÎµÎ¹ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ zoom Ï„Î¿ iPhone */
    }

    button { 
        background: #075e54; 
        color: white; 
        border: none; 
        width: 40px; 
        height: 40px; 
        border-radius: 50%; 
        font-size: 18px;
        cursor: pointer;
        flex-shrink: 0;
    }

    /* ÎœÎ·Î½ÏÎ¼Î±Ï„Î± ÏƒÏ„Ï…Î» WhatsApp */
    .msg { max-width: 80%; padding: 8px 12px; border-radius: 10px; margin-bottom: 5px; position: relative; font-size: 15px; }
    .user { align-self: flex-end; background: #dcf8c6; border-radius: 10px 0 10px 10px; }
    .ai { align-self: flex-start; background: white; border-radius: 0 10px 10px 10px; }

    .dots:after { content: ' .'; animation: dots 1.5s steps(5, end) infinite; }
    @keyframes dots { 0%, 20% { content: ' .'; } 40% { content: ' . .'; } 60% { content: ' . . .'; } 80%, 100% { content: ''; } }
</style>
</head>
<body>
    <div style="background: #075e54; color: white; padding: 15px; text-align: center; font-weight: bold;">ğŸ¹ Beach AI Assistant</div>
    <div id="chat-box">
        <div class="msg ai">Î“ÎµÎ¹Î± ÏƒÎ±Ï‚! Î•Î¯Î¼Î±Î¹ Î¿ ÏˆÎ·Ï†Î¹Î±ÎºÏŒÏ‚ ÏƒÎ±Ï‚ ÏƒÎµÏÎ²Î¹Ï„ÏŒÏÎ¿Ï‚. Î¤Î¹ Î¸Î± Î¸Î­Î»Î±Ï„Îµ Î½Î± Ï€Î±ÏÎ±Î³Î³ÎµÎ¯Î»ÎµÏ„Îµ; (ÎœÎ·Î½ Î¾ÎµÏ‡Î¬ÏƒÎµÏ„Îµ Ï„Î¿Î½ Î±ÏÎ¹Î¸Î¼ÏŒ Î¿Î¼Ï€ÏÎ­Î»Î±Ï‚!)</div>
    </div>
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Î“ÏÎ¬ÏˆÎµ ÎµÎ´Ï...">
        <button onclick="sendMessage()">Î£Ï„ÎµÎ¯Î»Îµ</button>
    </div>

    <script>
        function sendMessage() {
    let input = document.getElementById('userInput');
    let text = input.value;
    if(!text) return;

    let box = document.getElementById('chat-box');
    
    // 1. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚ Ï‡ÏÎ®ÏƒÏ„Î·
    box.innerHTML += `<div class="msg user">${text}</div>`;
    
    // 2. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Ï„Ï‰Î½ "3 dots" Ï‰Ï‚ Ï€ÏÎ¿ÏƒÏ‰ÏÎ¹Î½ÏŒ Î¼Î®Î½Ï…Î¼Î± AI
    let loadingId = "loading-" + Date.now();
    box.innerHTML += `<div id="${loadingId}" class="msg ai"><span class="dots"></span></div>`;
    
    input.value = "";
    box.scrollTop = box.scrollHeight;

    fetch('/chat', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({text: text})
    })
    .then(r => r.json())
    .then(data => {
        // 3. Î‘Ï†Î±Î¯ÏÎµÏƒÎ· Ï„Î¿Ï… loading bubble
        let loadingBubble = document.getElementById(loadingId);
        if(loadingBubble) loadingBubble.remove();

        // 4. Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Ï„Î·Ï‚ ÎºÎ±Î½Î¿Î½Î¹ÎºÎ®Ï‚ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚
        box.innerHTML += `<div class="msg ai">${data.reply}</div>`;
        box.scrollTop = box.scrollHeight;
    })
    .catch(err => {
        let loadingBubble = document.getElementById(loadingId);
        if(loadingBubble) loadingBubble.remove();
        box.innerHTML += `<div class="msg ai">Î£Ï†Î¬Î»Î¼Î± ÏƒÏÎ½Î´ÎµÏƒÎ·Ï‚...</div>`;
    });
}
    // Î Î¬ÏÎµ Ï„Î¿ Î½Î¿ÏÎ¼ÎµÏÎ¿ Ï„Î·Ï‚ Î¿Î¼Ï€ÏÎ­Î»Î±Ï‚ Ï€Î¿Ï… Î­ÏƒÏ„ÎµÎ¹Î»Îµ Î· Python
let umbrellaNumber = "{{ umbrella }}";

function sendMessage() {
    let userInput = document.getElementById('user-input').value;
    
    fetch('/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
            text: userInput, 
            umbrella: umbrellaNumber // Î£Ï„Î­Î»Î½Î¿Ï…Î¼Îµ Ï„Î¿ Î½Î¿ÏÎ¼ÎµÏÎ¿ Î±Ï…Ï„ÏŒÎ¼Î±Ï„Î±!
        })
    })
    .then(res => res.json())
    .then(data => {
        // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·Ï‚...
    });
}    
    </script>
</body>
</html>
